{"version":3,"file":"jsfitsio.js","mappings":"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","sources":["webpack://jsfitsio/webpack/universalModuleDefinition","webpack://jsfitsio/webpack/runtime/load script","webpack://jsfitsio/./node_modules/blob-polyfill/Blob.js","webpack://jsfitsio/webpack/bootstrap","webpack://jsfitsio/webpack/runtime/compat get default export","webpack://jsfitsio/webpack/runtime/define property getters","webpack://jsfitsio/webpack/runtime/ensure chunk","webpack://jsfitsio/webpack/runtime/get javascript chunk filename","webpack://jsfitsio/webpack/runtime/global","webpack://jsfitsio/webpack/runtime/hasOwnProperty shorthand","webpack://jsfitsio/webpack/runtime/make namespace object","webpack://jsfitsio/webpack/runtime/publicPath","webpack://jsfitsio/webpack/runtime/jsonp chunk loading","webpack://jsfitsio/./src/model/FITSHeaderItem.ts","webpack://jsfitsio/./src/model/FITSHeader.ts","webpack://jsfitsio/./src/ParseUtils.ts","webpack://jsfitsio/./src/FITSWriter.ts","webpack://jsfitsio/./src/ParsePayload.ts","webpack://jsfitsio/./src/ParseHeader.ts","webpack://jsfitsio/./src/FITSParser.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"jsfitsio\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"jsfitsio\"] = factory();\n\telse\n\t\troot[\"jsfitsio\"] = factory();\n})(self, () => {\nreturn ","var inProgress = {};\nvar dataWebpackPrefix = \"jsfitsio:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = (url, done, key, chunkId) => {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = (prev, event) => {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach((fn) => (fn(event)));\n\t\tif(prev) return prev(event);\n\t}\n\t;\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","/* Blob.js\n * A Blob, File, FileReader & URL implementation.\n * 2020-02-01\n *\n * By Eli Grey, https://eligrey.com\n * By Jimmy Wärting, https://github.com/jimmywarting\n * License: MIT\n *   See https://github.com/eligrey/Blob.js/blob/master/LICENSE.md\n */\n\n(function(global) {\n\t(function (factory) {\n\t\tif (typeof define === \"function\" && define.amd) {\n\t\t\t// AMD. Register as an anonymous module.\n\t\t\tdefine([\"exports\"], factory);\n\t\t} else if (typeof exports === \"object\" && typeof exports.nodeName !== \"string\") {\n\t\t\t// CommonJS\n\t\t\tfactory(exports);\n\t\t} else {\n\t\t\t// Browser globals\n\t\t\tfactory(global);\n\t\t}\n\t})(function (exports) {\n\t\t\"use strict\";\n\n\t\tvar BlobBuilder = global.BlobBuilder\n\t\t\t|| global.WebKitBlobBuilder\n\t\t\t|| global.MSBlobBuilder\n\t\t\t|| global.MozBlobBuilder;\n\n\t\tvar URL = global.URL || global.webkitURL || function (href, a) {\n\t\t\ta = document.createElement(\"a\");\n\t\t\ta.href = href;\n\t\t\treturn a;\n\t\t};\n\n\t\tvar origBlob = global.Blob;\n\t\tvar createObjectURL = URL.createObjectURL;\n\t\tvar revokeObjectURL = URL.revokeObjectURL;\n\t\tvar strTag = global.Symbol && global.Symbol.toStringTag;\n\t\tvar blobSupported = false;\n\t\tvar blobSupportsArrayBufferView = false;\n\t\tvar blobBuilderSupported = BlobBuilder\n\t\t\t&& BlobBuilder.prototype.append\n\t\t\t&& BlobBuilder.prototype.getBlob;\n\n\t\ttry {\n\t\t\t// Check if Blob constructor is supported\n\t\t\tblobSupported = new Blob([\"ä\"]).size === 2;\n\n\t\t\t// Check if Blob constructor supports ArrayBufferViews\n\t\t\t// Fails in Safari 6, so we need to map to ArrayBuffers there.\n\t\t\tblobSupportsArrayBufferView = new Blob([new Uint8Array([1, 2])]).size === 2;\n\t\t} catch (e) {/**/}\n\n\n\t\t// Helper function that maps ArrayBufferViews to ArrayBuffers\n\t\t// Used by BlobBuilder constructor and old browsers that didn't\n\t\t// support it in the Blob constructor.\n\t\tfunction mapArrayBufferViews (ary) {\n\t\t\treturn ary.map(function (chunk) {\n\t\t\t\tif (chunk.buffer instanceof ArrayBuffer) {\n\t\t\t\t\tvar buf = chunk.buffer;\n\n\t\t\t\t\t// if this is a subarray, make a copy so we only\n\t\t\t\t\t// include the subarray region from the underlying buffer\n\t\t\t\t\tif (chunk.byteLength !== buf.byteLength) {\n\t\t\t\t\t\tvar copy = new Uint8Array(chunk.byteLength);\n\t\t\t\t\t\tcopy.set(new Uint8Array(buf, chunk.byteOffset, chunk.byteLength));\n\t\t\t\t\t\tbuf = copy.buffer;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn buf;\n\t\t\t\t}\n\n\t\t\t\treturn chunk;\n\t\t\t});\n\t\t}\n\n\t\tfunction BlobBuilderConstructor (ary, options) {\n\t\t\toptions = options || {};\n\n\t\t\tvar bb = new BlobBuilder();\n\t\t\tmapArrayBufferViews(ary).forEach(function (part) {\n\t\t\t\tbb.append(part);\n\t\t\t});\n\n\t\t\treturn options.type ? bb.getBlob(options.type) : bb.getBlob();\n\t\t}\n\n\t\tfunction BlobConstructor (ary, options) {\n\t\t\treturn new origBlob(mapArrayBufferViews(ary), options || {});\n\t\t}\n\n\t\tif (global.Blob) {\n\t\t\tBlobBuilderConstructor.prototype = Blob.prototype;\n\t\t\tBlobConstructor.prototype = Blob.prototype;\n\t\t}\n\n\t\t/********************************************************/\n\t\t/*               String Encoder fallback                */\n\t\t/********************************************************/\n\t\tfunction stringEncode (string) {\n\t\t\tvar pos = 0;\n\t\t\tvar len = string.length;\n\t\t\tvar Arr = global.Uint8Array || Array; // Use byte array when possible\n\n\t\t\tvar at = 0; // output position\n\t\t\tvar tlen = Math.max(32, len + (len >> 1) + 7); // 1.5x size\n\t\t\tvar target = new Arr((tlen >> 3) << 3); // ... but at 8 byte offset\n\n\t\t\twhile (pos < len) {\n\t\t\t\tvar value = string.charCodeAt(pos++);\n\t\t\t\tif (value >= 0xd800 && value <= 0xdbff) {\n\t\t\t\t\t// high surrogate\n\t\t\t\t\tif (pos < len) {\n\t\t\t\t\t\tvar extra = string.charCodeAt(pos);\n\t\t\t\t\t\tif ((extra & 0xfc00) === 0xdc00) {\n\t\t\t\t\t\t\t++pos;\n\t\t\t\t\t\t\tvalue = ((value & 0x3ff) << 10) + (extra & 0x3ff) + 0x10000;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (value >= 0xd800 && value <= 0xdbff) {\n\t\t\t\t\t\tcontinue; // drop lone surrogate\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// expand the buffer if we couldn't write 4 bytes\n\t\t\t\tif (at + 4 > target.length) {\n\t\t\t\t\ttlen += 8; // minimum extra\n\t\t\t\t\ttlen *= (1.0 + (pos / string.length) * 2); // take 2x the remaining\n\t\t\t\t\ttlen = (tlen >> 3) << 3; // 8 byte offset\n\n\t\t\t\t\tvar update = new Uint8Array(tlen);\n\t\t\t\t\tupdate.set(target);\n\t\t\t\t\ttarget = update;\n\t\t\t\t}\n\n\t\t\t\tif ((value & 0xffffff80) === 0) { // 1-byte\n\t\t\t\t\ttarget[at++] = value; // ASCII\n\t\t\t\t\tcontinue;\n\t\t\t\t} else if ((value & 0xfffff800) === 0) { // 2-byte\n\t\t\t\t\ttarget[at++] = ((value >> 6) & 0x1f) | 0xc0;\n\t\t\t\t} else if ((value & 0xffff0000) === 0) { // 3-byte\n\t\t\t\t\ttarget[at++] = ((value >> 12) & 0x0f) | 0xe0;\n\t\t\t\t\ttarget[at++] = ((value >> 6) & 0x3f) | 0x80;\n\t\t\t\t} else if ((value & 0xffe00000) === 0) { // 4-byte\n\t\t\t\t\ttarget[at++] = ((value >> 18) & 0x07) | 0xf0;\n\t\t\t\t\ttarget[at++] = ((value >> 12) & 0x3f) | 0x80;\n\t\t\t\t\ttarget[at++] = ((value >> 6) & 0x3f) | 0x80;\n\t\t\t\t} else {\n\t\t\t\t\t// FIXME: do we care\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\ttarget[at++] = (value & 0x3f) | 0x80;\n\t\t\t}\n\n\t\t\treturn target.slice(0, at);\n\t\t}\n\n\t\t/********************************************************/\n\t\t/*               String Decoder fallback                */\n\t\t/********************************************************/\n\t\tfunction stringDecode (buf) {\n\t\t\tvar end = buf.length;\n\t\t\tvar res = [];\n\n\t\t\tvar i = 0;\n\t\t\twhile (i < end) {\n\t\t\t\tvar firstByte = buf[i];\n\t\t\t\tvar codePoint = null;\n\t\t\t\tvar bytesPerSequence = (firstByte > 0xEF) ? 4\n\t\t\t\t\t: (firstByte > 0xDF) ? 3\n\t\t\t\t\t\t: (firstByte > 0xBF) ? 2\n\t\t\t\t\t\t\t: 1;\n\n\t\t\t\tif (i + bytesPerSequence <= end) {\n\t\t\t\t\tvar secondByte, thirdByte, fourthByte, tempCodePoint;\n\n\t\t\t\t\tswitch (bytesPerSequence) {\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\tif (firstByte < 0x80) {\n\t\t\t\t\t\t\tcodePoint = firstByte;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\tsecondByte = buf[i + 1];\n\t\t\t\t\t\tif ((secondByte & 0xC0) === 0x80) {\n\t\t\t\t\t\t\ttempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F);\n\t\t\t\t\t\t\tif (tempCodePoint > 0x7F) {\n\t\t\t\t\t\t\t\tcodePoint = tempCodePoint;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 3:\n\t\t\t\t\t\tsecondByte = buf[i + 1];\n\t\t\t\t\t\tthirdByte = buf[i + 2];\n\t\t\t\t\t\tif ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n\t\t\t\t\t\t\ttempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F);\n\t\t\t\t\t\t\tif (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n\t\t\t\t\t\t\t\tcodePoint = tempCodePoint;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 4:\n\t\t\t\t\t\tsecondByte = buf[i + 1];\n\t\t\t\t\t\tthirdByte = buf[i + 2];\n\t\t\t\t\t\tfourthByte = buf[i + 3];\n\t\t\t\t\t\tif ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n\t\t\t\t\t\t\ttempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F);\n\t\t\t\t\t\t\tif (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n\t\t\t\t\t\t\t\tcodePoint = tempCodePoint;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (codePoint === null) {\n\t\t\t\t\t// we did not generate a valid codePoint so insert a\n\t\t\t\t\t// replacement char (U+FFFD) and advance only 1 byte\n\t\t\t\t\tcodePoint = 0xFFFD;\n\t\t\t\t\tbytesPerSequence = 1;\n\t\t\t\t} else if (codePoint > 0xFFFF) {\n\t\t\t\t\t// encode to utf16 (surrogate pair dance)\n\t\t\t\t\tcodePoint -= 0x10000;\n\t\t\t\t\tres.push(codePoint >>> 10 & 0x3FF | 0xD800);\n\t\t\t\t\tcodePoint = 0xDC00 | codePoint & 0x3FF;\n\t\t\t\t}\n\n\t\t\t\tres.push(codePoint);\n\t\t\t\ti += bytesPerSequence;\n\t\t\t}\n\n\t\t\tvar len = res.length;\n\t\t\tvar str = \"\";\n\t\t\tvar j = 0;\n\n\t\t\twhile (j < len) {\n\t\t\t\tstr += String.fromCharCode.apply(String, res.slice(j, j += 0x1000));\n\t\t\t}\n\n\t\t\treturn str;\n\t\t}\n\n\t\t// string -> buffer\n\t\tvar textEncode = typeof TextEncoder === \"function\"\n\t\t\t? TextEncoder.prototype.encode.bind(new TextEncoder())\n\t\t\t: stringEncode;\n\n\t\t// buffer -> string\n\t\tvar textDecode = typeof TextDecoder === \"function\"\n\t\t\t? TextDecoder.prototype.decode.bind(new TextDecoder())\n\t\t\t: stringDecode;\n\n\t\tfunction FakeBlobBuilder () {\n\t\t\tfunction bufferClone (buf) {\n\t\t\t\tvar view = new Array(buf.byteLength);\n\t\t\t\tvar array = new Uint8Array(buf);\n\t\t\t\tvar i = view.length;\n\t\t\t\twhile (i--) {\n\t\t\t\t\tview[i] = array[i];\n\t\t\t\t}\n\t\t\t\treturn view;\n\t\t\t}\n\t\t\tfunction array2base64 (input) {\n\t\t\t\tvar byteToCharMap = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\n\n\t\t\t\tvar output = [];\n\n\t\t\t\tfor (var i = 0; i < input.length; i += 3) {\n\t\t\t\t\tvar byte1 = input[i];\n\t\t\t\t\tvar haveByte2 = i + 1 < input.length;\n\t\t\t\t\tvar byte2 = haveByte2 ? input[i + 1] : 0;\n\t\t\t\t\tvar haveByte3 = i + 2 < input.length;\n\t\t\t\t\tvar byte3 = haveByte3 ? input[i + 2] : 0;\n\n\t\t\t\t\tvar outByte1 = byte1 >> 2;\n\t\t\t\t\tvar outByte2 = ((byte1 & 0x03) << 4) | (byte2 >> 4);\n\t\t\t\t\tvar outByte3 = ((byte2 & 0x0F) << 2) | (byte3 >> 6);\n\t\t\t\t\tvar outByte4 = byte3 & 0x3F;\n\n\t\t\t\t\tif (!haveByte3) {\n\t\t\t\t\t\toutByte4 = 64;\n\n\t\t\t\t\t\tif (!haveByte2) {\n\t\t\t\t\t\t\toutByte3 = 64;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\toutput.push(\n\t\t\t\t\t\tbyteToCharMap[outByte1], byteToCharMap[outByte2],\n\t\t\t\t\t\tbyteToCharMap[outByte3], byteToCharMap[outByte4]\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\treturn output.join(\"\");\n\t\t\t}\n\n\t\t\tvar create = Object.create || function (a) {\n\t\t\t\tfunction c () {}\n\t\t\t\tc.prototype = a;\n\t\t\t\treturn new c();\n\t\t\t};\n\n\t\t\tfunction getObjectTypeName (o) {\n\t\t\t\treturn Object.prototype.toString.call(o).slice(8, -1);\n\t\t\t}\n\n\t\t\tfunction isPrototypeOf(c, o) {\n\t\t\t\treturn typeof c === \"object\" && Object.prototype.isPrototypeOf.call(c.prototype, o);\n\t\t\t}\n\n\t\t\tfunction isDataView (o) {\n\t\t\t\treturn getObjectTypeName(o) === \"DataView\" || isPrototypeOf(global.DataView, o);\n\t\t\t}\n\n\t\t\tvar arrayBufferClassNames = [\n\t\t\t\t\"Int8Array\",\n\t\t\t\t\"Uint8Array\",\n\t\t\t\t\"Uint8ClampedArray\",\n\t\t\t\t\"Int16Array\",\n\t\t\t\t\"Uint16Array\",\n\t\t\t\t\"Int32Array\",\n\t\t\t\t\"Uint32Array\",\n\t\t\t\t\"Float32Array\",\n\t\t\t\t\"Float64Array\",\n\t\t\t\t\"ArrayBuffer\"\n\t\t\t];\n\n\t\t\tfunction includes(a, v) {\n\t\t\t\treturn a.indexOf(v) !== -1;\n\t\t\t}\n\n\t\t\tfunction isArrayBuffer(o) {\n\t\t\t\treturn includes(arrayBufferClassNames, getObjectTypeName(o)) || isPrototypeOf(global.ArrayBuffer, o);\n\t\t\t}\n\n\t\t\tfunction concatTypedarrays (chunks) {\n\t\t\t\tvar size = 0;\n\t\t\t\tvar j = chunks.length;\n\t\t\t\twhile (j--) { size += chunks[j].length; }\n\t\t\t\tvar b = new Uint8Array(size);\n\t\t\t\tvar offset = 0;\n\t\t\t\tfor (var i = 0; i < chunks.length; i++) {\n\t\t\t\t\tvar chunk = chunks[i];\n\t\t\t\t\tb.set(chunk, offset);\n\t\t\t\t\toffset += chunk.byteLength || chunk.length;\n\t\t\t\t}\n\n\t\t\t\treturn b;\n\t\t\t}\n\n\t\t\t/********************************************************/\n\t\t\t/*                   Blob constructor                   */\n\t\t\t/********************************************************/\n\t\t\tfunction Blob (chunks, opts) {\n\t\t\t\tchunks = chunks ? chunks.slice() : [];\n\t\t\t\topts = opts == null ? {} : opts;\n\t\t\t\tfor (var i = 0, len = chunks.length; i < len; i++) {\n\t\t\t\t\tvar chunk = chunks[i];\n\t\t\t\t\tif (chunk instanceof Blob) {\n\t\t\t\t\t\tchunks[i] = chunk._buffer;\n\t\t\t\t\t} else if (typeof chunk === \"string\") {\n\t\t\t\t\t\tchunks[i] = textEncode(chunk);\n\t\t\t\t\t} else if (isDataView(chunk)) {\n\t\t\t\t\t\tchunks[i] = bufferClone(chunk.buffer);\n\t\t\t\t\t} else if (isArrayBuffer(chunk)) {\n\t\t\t\t\t\tchunks[i] = bufferClone(chunk);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tchunks[i] = textEncode(String(chunk));\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis._buffer = global.Uint8Array\n\t\t\t\t\t? concatTypedarrays(chunks)\n\t\t\t\t\t: [].concat.apply([], chunks);\n\t\t\t\tthis.size = this._buffer.length;\n\n\t\t\t\tthis.type = opts.type || \"\";\n\t\t\t\tif (/[^\\u0020-\\u007E]/.test(this.type)) {\n\t\t\t\t\tthis.type = \"\";\n\t\t\t\t} else {\n\t\t\t\t\tthis.type = this.type.toLowerCase();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tBlob.prototype.arrayBuffer = function () {\n\t\t\t\treturn Promise.resolve(this._buffer.buffer || this._buffer);\n\t\t\t};\n\n\t\t\tBlob.prototype.text = function () {\n\t\t\t\treturn Promise.resolve(textDecode(this._buffer));\n\t\t\t};\n\n\t\t\tBlob.prototype.slice = function (start, end, type) {\n\t\t\t\tvar slice = this._buffer.slice(start || 0, end || this._buffer.length);\n\t\t\t\treturn new Blob([slice], {type: type});\n\t\t\t};\n\n\t\t\tBlob.prototype.toString = function () {\n\t\t\t\treturn \"[object Blob]\";\n\t\t\t};\n\n\t\t\t/********************************************************/\n\t\t\t/*                   File constructor                   */\n\t\t\t/********************************************************/\n\t\t\tfunction File (chunks, name, opts) {\n\t\t\t\topts = opts || {};\n\t\t\t\tvar a = Blob.call(this, chunks, opts) || this;\n\t\t\t\ta.name = name.replace(/\\//g, \":\");\n\t\t\t\ta.lastModifiedDate = opts.lastModified ? new Date(opts.lastModified) : new Date();\n\t\t\t\ta.lastModified = +a.lastModifiedDate;\n\n\t\t\t\treturn a;\n\t\t\t}\n\n\t\t\tFile.prototype = create(Blob.prototype);\n\t\t\tFile.prototype.constructor = File;\n\n\t\t\tif (Object.setPrototypeOf) {\n\t\t\t\tObject.setPrototypeOf(File, Blob);\n\t\t\t} else {\n\t\t\t\ttry {\n\t\t\t\t\tFile.__proto__ = Blob;\n\t\t\t\t} catch (e) {/**/}\n\t\t\t}\n\n\t\t\tFile.prototype.toString = function () {\n\t\t\t\treturn \"[object File]\";\n\t\t\t};\n\n\t\t\t/********************************************************/\n\t\t\t/*                FileReader constructor                */\n\t\t\t/********************************************************/\n\t\t\tfunction FileReader () {\n\t\t\t\tif (!(this instanceof FileReader)) {\n\t\t\t\t\tthrow new TypeError(\"Failed to construct 'FileReader': Please use the 'new' operator, this DOM object constructor cannot be called as a function.\");\n\t\t\t\t}\n\n\t\t\t\tvar delegate = document.createDocumentFragment();\n\t\t\t\tthis.addEventListener = delegate.addEventListener;\n\t\t\t\tthis.dispatchEvent = function (evt) {\n\t\t\t\t\tvar local = this[\"on\" + evt.type];\n\t\t\t\t\tif (typeof local === \"function\") local(evt);\n\t\t\t\t\tdelegate.dispatchEvent(evt);\n\t\t\t\t};\n\t\t\t\tthis.removeEventListener = delegate.removeEventListener;\n\t\t\t}\n\n\t\t\tfunction _read (fr, blob, kind) {\n\t\t\t\tif (!(blob instanceof Blob)) {\n\t\t\t\t\tthrow new TypeError(\"Failed to execute '\" + kind + \"' on 'FileReader': parameter 1 is not of type 'Blob'.\");\n\t\t\t\t}\n\n\t\t\t\tfr.result = \"\";\n\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\tthis.readyState = FileReader.LOADING;\n\t\t\t\t\tfr.dispatchEvent(new Event(\"load\"));\n\t\t\t\t\tfr.dispatchEvent(new Event(\"loadend\"));\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tFileReader.EMPTY = 0;\n\t\t\tFileReader.LOADING = 1;\n\t\t\tFileReader.DONE = 2;\n\t\t\tFileReader.prototype.error = null;\n\t\t\tFileReader.prototype.onabort = null;\n\t\t\tFileReader.prototype.onerror = null;\n\t\t\tFileReader.prototype.onload = null;\n\t\t\tFileReader.prototype.onloadend = null;\n\t\t\tFileReader.prototype.onloadstart = null;\n\t\t\tFileReader.prototype.onprogress = null;\n\n\t\t\tFileReader.prototype.readAsDataURL = function (blob) {\n\t\t\t\t_read(this, blob, \"readAsDataURL\");\n\t\t\t\tthis.result = \"data:\" + blob.type + \";base64,\" + array2base64(blob._buffer);\n\t\t\t};\n\n\t\t\tFileReader.prototype.readAsText = function (blob) {\n\t\t\t\t_read(this, blob, \"readAsText\");\n\t\t\t\tthis.result = textDecode(blob._buffer);\n\t\t\t};\n\n\t\t\tFileReader.prototype.readAsArrayBuffer = function (blob) {\n\t\t\t\t_read(this, blob, \"readAsText\");\n\t\t\t\t// return ArrayBuffer when possible\n\t\t\t\tthis.result = (blob._buffer.buffer || blob._buffer).slice();\n\t\t\t};\n\n\t\t\tFileReader.prototype.abort = function () {};\n\n\t\t\t/********************************************************/\n\t\t\t/*                         URL                          */\n\t\t\t/********************************************************/\n\t\t\tURL.createObjectURL = function (blob) {\n\t\t\t\treturn blob instanceof Blob\n\t\t\t\t\t? \"data:\" + blob.type + \";base64,\" + array2base64(blob._buffer)\n\t\t\t\t\t: createObjectURL.call(URL, blob);\n\t\t\t};\n\n\t\t\tURL.revokeObjectURL = function (url) {\n\t\t\t\trevokeObjectURL && revokeObjectURL.call(URL, url);\n\t\t\t};\n\n\t\t\t/********************************************************/\n\t\t\t/*                         XHR                          */\n\t\t\t/********************************************************/\n\t\t\tvar _send = global.XMLHttpRequest && global.XMLHttpRequest.prototype.send;\n\t\t\tif (_send) {\n\t\t\t\tXMLHttpRequest.prototype.send = function (data) {\n\t\t\t\t\tif (data instanceof Blob) {\n\t\t\t\t\t\tthis.setRequestHeader(\"Content-Type\", data.type);\n\t\t\t\t\t\t_send.call(this, textDecode(data._buffer));\n\t\t\t\t\t} else {\n\t\t\t\t\t\t_send.call(this, data);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\n\t\t\texports.Blob = Blob;\n\t\t\texports.File = File;\n\t\t\texports.FileReader = FileReader;\n\t\t\texports.URL = URL;\n\t\t}\n\n\t\tfunction fixFileAndXHR () {\n\t\t\tvar isIE = !!global.ActiveXObject || (\n\t\t\t\t\"-ms-scroll-limit\" in document.documentElement.style &&\n\t\t\t\t\"-ms-ime-align\" in document.documentElement.style\n\t\t\t);\n\n\t\t\t// Monkey patched\n\t\t\t// IE doesn't set Content-Type header on XHR whose body is a typed Blob\n\t\t\t// https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/6047383\n\t\t\tvar _send = global.XMLHttpRequest && global.XMLHttpRequest.prototype.send;\n\t\t\tif (isIE && _send) {\n\t\t\t\tXMLHttpRequest.prototype.send = function (data) {\n\t\t\t\t\tif (data instanceof Blob) {\n\t\t\t\t\t\tthis.setRequestHeader(\"Content-Type\", data.type);\n\t\t\t\t\t\t_send.call(this, data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t_send.call(this, data);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tnew File([], \"\");\n\t\t\t\texports.File = global.File;\n\t\t\t\texports.FileReader = global.FileReader;\n\t\t\t} catch (e) {\n\t\t\t\ttry {\n\t\t\t\t\texports.File = new Function(\"class File extends Blob {\" +\n\t\t\t\t\t\t\"constructor(chunks, name, opts) {\" +\n\t\t\t\t\t\t\t\"opts = opts || {};\" +\n\t\t\t\t\t\t\t\"super(chunks, opts || {});\" +\n\t\t\t\t\t\t\t\"this.name = name.replace(/\\\\//g, \\\":\\\");\" +\n\t\t\t\t\t\t\t\"this.lastModifiedDate = opts.lastModified ? new Date(opts.lastModified) : new Date();\" +\n\t\t\t\t\t\t\t\"this.lastModified = +this.lastModifiedDate;\" +\n\t\t\t\t\t\t\"}};\" +\n\t\t\t\t\t\t\"return new File([], \\\"\\\"), File\"\n\t\t\t\t\t)();\n\t\t\t\t} catch (e) {\n\t\t\t\t\texports.File = function (b, d, c) {\n\t\t\t\t\t\tvar blob = new Blob(b, c);\n\t\t\t\t\t\tvar t = c && void 0 !== c.lastModified ? new Date(c.lastModified) : new Date();\n\n\t\t\t\t\t\tblob.name = d.replace(/\\//g, \":\");\n\t\t\t\t\t\tblob.lastModifiedDate = t;\n\t\t\t\t\t\tblob.lastModified = +t;\n\t\t\t\t\t\tblob.toString = function () {\n\t\t\t\t\t\t\treturn \"[object File]\";\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tif (strTag) {\n\t\t\t\t\t\t\tblob[strTag] = \"File\";\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn blob;\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (blobSupported) {\n\t\t\tfixFileAndXHR();\n\t\t\texports.Blob = blobSupportsArrayBufferView ? global.Blob : BlobConstructor;\n\t\t} else if (blobBuilderSupported) {\n\t\t\tfixFileAndXHR();\n\t\t\texports.Blob = BlobBuilderConstructor;\n\t\t} else {\n\t\t\tFakeBlobBuilder();\n\t\t}\n\n\t\tif (strTag) {\n\t\t\tif (!exports.File.prototype[strTag]) exports.File.prototype[strTag] = \"File\";\n\t\t\tif (!exports.Blob.prototype[strTag]) exports.Blob.prototype[strTag] = \"Blob\";\n\t\t\tif (!exports.FileReader.prototype[strTag]) exports.FileReader.prototype[strTag] = \"FileReader\";\n\t\t}\n\n\t\tvar blob = exports.Blob.prototype;\n\t\tvar stream;\n\n\t\ttry {\n\t\t\tnew ReadableStream({ type: \"bytes\" });\n\t\t\tstream = function stream() {\n\t\t\t\tvar position = 0;\n\t\t\t\tvar blob = this;\n\n\t\t\t\treturn new ReadableStream({\n\t\t\t\t\ttype: \"bytes\",\n\t\t\t\t\tautoAllocateChunkSize: 524288,\n\n\t\t\t\t\tpull: function (controller) {\n\t\t\t\t\t\tvar v = controller.byobRequest.view;\n\t\t\t\t\t\tvar chunk = blob.slice(position, position + v.byteLength);\n\t\t\t\t\t\treturn chunk.arrayBuffer()\n\t\t\t\t\t\t\t.then(function (buffer) {\n\t\t\t\t\t\t\t\tvar uint8array = new Uint8Array(buffer);\n\t\t\t\t\t\t\t\tvar bytesRead = uint8array.byteLength;\n\n\t\t\t\t\t\t\t\tposition += bytesRead;\n\t\t\t\t\t\t\t\tv.set(uint8array);\n\t\t\t\t\t\t\t\tcontroller.byobRequest.respond(bytesRead);\n\n\t\t\t\t\t\t\t\tif(position >= blob.size)\n\t\t\t\t\t\t\t\t\tcontroller.close();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t};\n\t\t} catch (e) {\n\t\t\ttry {\n\t\t\t\tnew ReadableStream({});\n\t\t\t\tstream = function stream(blob){\n\t\t\t\t\tvar position = 0;\n\n\t\t\t\t\treturn new ReadableStream({\n\t\t\t\t\t\tpull: function (controller) {\n\t\t\t\t\t\t\tvar chunk = blob.slice(position, position + 524288);\n\n\t\t\t\t\t\t\treturn chunk.arrayBuffer().then(function (buffer) {\n\t\t\t\t\t\t\t\tposition += buffer.byteLength;\n\t\t\t\t\t\t\t\tvar uint8array = new Uint8Array(buffer);\n\t\t\t\t\t\t\t\tcontroller.enqueue(uint8array);\n\n\t\t\t\t\t\t\t\tif (position == blob.size)\n\t\t\t\t\t\t\t\t\tcontroller.close();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t};\n\t\t\t} catch (e) {\n\t\t\t\ttry {\n\t\t\t\t\tnew Response(\"\").body.getReader().read();\n\t\t\t\t\tstream = function stream() {\n\t\t\t\t\t\treturn (new Response(this)).body;\n\t\t\t\t\t};\n\t\t\t\t} catch (e) {\n\t\t\t\t\tstream = function stream() {\n\t\t\t\t\t\tthrow new Error(\"Include https://github.com/MattiasBuelens/web-streams-polyfill\");\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction promisify(obj) {\n\t\t\treturn new Promise(function(resolve, reject) {\n\t\t\t\tobj.onload = obj.onerror = function(evt) {\n\t\t\t\t\tobj.onload = obj.onerror = null;\n\n\t\t\t\t\tevt.type === \"load\" ?\n\t\t\t\t\t\tresolve(obj.result || obj) :\n\t\t\t\t\t\treject(new Error(\"Failed to read the blob/file\"));\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\n\t\tif (!blob.arrayBuffer) {\n\t\t\tblob.arrayBuffer = function arrayBuffer() {\n\t\t\t\tvar fr = new FileReader();\n\t\t\t\tfr.readAsArrayBuffer(this);\n\t\t\t\treturn promisify(fr);\n\t\t\t};\n\t\t}\n\n\t\tif (!blob.text) {\n\t\t\tblob.text = function text() {\n\t\t\t\tvar fr = new FileReader();\n\t\t\t\tfr.readAsText(this);\n\t\t\t\treturn promisify(fr);\n\t\t\t};\n\t\t}\n\n\t\tif (!blob.stream) {\n\t\t\tblob.stream = stream;\n\t\t}\n\t});\n})(\n\ttypeof self !== \"undefined\" && self ||\n\t\ttypeof window !== \"undefined\" && window ||\n\t\ttypeof global !== \"undefined\" && global ||\n\t\tthis\n);\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"\" + chunkId + \".bundle.js?h=\" + {\"437\":\"0097536bf1b322cc2ab1\",\"662\":\"215269815ed9e9913038\"}[chunkId] + \"\";\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript)\n\t\tscriptUrl = document.currentScript.src\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) scriptUrl = scripts[scripts.length - 1].src\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t577: 0,\n\t569: 0\n};\n\n__webpack_require__.f.j = (chunkId, promises) => {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise((resolve, reject) => (installedChunkData = installedChunks[chunkId] = [resolve, reject]));\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = (event) => {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t} else installedChunks[chunkId] = 0;\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkjsfitsio\"] = self[\"webpackChunkjsfitsio\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","/**\n * Summary. (bla bla bla)\n *\n * Description. (bla bla bla)\n *\n * @link   github https://github.com/fab77/FITSParser\n * @author Fabrizio Giordano <fabriziogiordano77@gmail.com>\n */\n\nexport class FITSHeaderItem {\n  _key: string | undefined;\n  _value: string | number | undefined;\n  _comment: string | undefined;\n\n  constructor(key?: string, value?: string | number, comment?: string) {\n    this._key = key !== undefined ? key : undefined;\n    this._value = value !== undefined ? value : undefined;\n    this._comment = comment !== undefined ? comment : undefined;\n  }\n\n  get key() {\n    return this._key;\n  }\n\n  get comment() {\n    return this._comment;\n  }\n\n  get value() {\n    return this._value;\n  }\n}\n","import { FITSHeaderItem } from \"./FITSHeaderItem.js\";\n\n/**\n * Summary. (bla bla bla)\n *\n * Description. (bla bla bla)\n *\n * @link   github https://github.com/fab77/FITSParser\n * @author Fabrizio Giordano <fabriziogiordano77@gmail.com>\n */\n\n// reference FTIS standard doc https://heasarc.gsfc.nasa.gov/docs/fcg/standard_dict.html\n\nexport class FITSHeader extends Map {\n  _offset: number | undefined;\n  _items: FITSHeaderItem[];\n\n  constructor() {\n    super();\n    this._offset = undefined;\n    this._items = [];\n  }\n\n  set offset(offset) {\n    this._offset = offset;\n  }\n\n  get offset() {\n    return this._offset;\n  }\n\n  getItemList() {\n    return this._items;\n  }\n\n  getItemListOf(key: string) {\n    const res = [];\n    for (let i = 0; i < this._items.length; i++) {\n      const item = this._items[i];\n      if (item.key == key) {\n        res.push(item);\n      }\n    }\n    return res;\n  }\n\n  addItemAtTheBeginning(item: FITSHeaderItem) {\n    if (item.key !== undefined) {\n      if (\n        [\n          \"SIMPLE\",\n          \"BITPIX\",\n          \"NAXIS\",\n          \"NAXIS1\",\n          \"NAXIS2\",\n          \"BLANK\",\n          \"BZERO\",\n          \"BSCALE\",\n          \"DATAMIN\",\n          \"DATAMAX\",\n          \"NPIX\",\n          \"ORDER\",\n          \"CRPIX1\",\n          \"CRPIX2\",\n          \"CDELT1\",\n          \"CDELT2\",\n        ].includes(item.key)\n      ) {\n        this.set(item.key, item.value);\n      }\n    }\n    \n    const newitemlist = [item].concat(this._items);\n    this._items = newitemlist;\n  }\n\n\n\n  addItem(item: FITSHeaderItem) {\n    if (item.key !== undefined) {\n      if (\n        [\n          \"SIMPLE\",\n          \"BITPIX\",\n          \"NAXIS\",\n          \"NAXIS1\",\n          \"NAXIS2\",\n          \"BLANK\",\n          \"BZERO\",\n          \"BSCALE\",\n          \"DATAMIN\",\n          \"DATAMAX\",\n          \"NPIX\",\n          \"ORDER\",\n          \"CRPIX1\",\n          \"CRPIX2\",\n          \"CDELT1\",\n          \"CDELT2\",\n        ].includes(item.key)\n      ) {\n        this.set(item.key, item.value);\n      }\n    }\n    this._items.push(item);\n  }\n\n  getNumRows() {\n    return this._items.length;\n  }\n}\n","/**\n * Summary. (bla bla bla)\n *\n * Description. (bla bla bla)\n *\n * @link   github https://github.com/fab77/FITSParser\n * @author Fabrizio Giordano <fabriziogiordano77@gmail.com>\n */\n\nexport class ParseUtils {\n  static getStringAt(data: string, offset: number, length: number) {\n    const chars: string[] = [];\n    for (let i = offset, j = 0; i < offset + length; i++, j++) {\n      chars[j] = String.fromCharCode(data.charCodeAt(i) & 0xff);\n    }\n    return chars.join(\"\");\n  }\n\n  static byteString(n: number): string {\n    if (n < 0 || n > 255 || n % 1 !== 0) {\n      throw new Error(n + \" does not fit in a byte\");\n    }\n    return (\"000000000\" + n.toString(2)).substr(-8);\n  }\n\n  static parse32bitSinglePrecisionFloatingPoint(\n    byte1: number,\n    byte2: number,\n    byte3: number,\n    byte4: number\n  ): number {\n    let long = (((((byte1 << 8) + byte2) << 8) + byte3) << 8) + byte4;\n    if (long < 0) long += 4294967296;\n    const float =\n      (1.0 + (long & 0x007fffff) / 0x0800000) *\n      Math.pow(2, ((long & 0x7f800000) >> 23) - 127);\n    return float;\n  }\n\n  static convertBlankToBytes(blank: number, nbytes: number): Uint8Array {\n    let str = Math.abs(blank).toString(2);\n    while (str.length / 8 < nbytes) {\n      str += \"0\";\n    }\n    const buffer = new ArrayBuffer(nbytes);\n    const uint8 = new Uint8Array(buffer);\n    for (let i = 0; i < nbytes; i++) {\n      uint8[i] = parseInt(str.substr(8 * i, 8 * (i + 1)), 2);\n    }\n    return uint8;\n  }\n  /** https://gist.github.com/Manouchehri/f4b41c8272db2d6423fa987e844dd9ac */\n  static parseFloatingPointFormat(\n    bytes: Uint8Array,\n    ebits: number,\n    fbits: number\n  ): number | undefined {\n    // Bytes to bits\n    const bits = [];\n    for (let i = bytes.length; i; i -= 1) {\n      let byte = bytes[i - 1];\n      for (let j = 8; j; j -= 1) {\n        bits.push(byte % 2 ? 1 : 0);\n        byte = byte >> 1;\n      }\n    }\n    bits.reverse();\n    const str = bits.join(\"\");\n    // Unpack sign, exponent, fraction\n    const bias = (1 << (ebits - 1)) - 1;\n    const s = parseInt(str.substring(0, 1), 2) ? -1 : 1;\n    const e = parseInt(str.substring(1, 1 + ebits), 2);\n    const f = parseInt(str.substring(1 + ebits), 2);\n\n    // Produce number\n    if (e === (1 << ebits) - 1) {\n      return f !== 0 ? undefined : s * Infinity;\n    } else if (e > 0) {\n      return s * Math.pow(2, e - bias) * (1 + f / Math.pow(2, fbits));\n    } else if (f !== 0) {\n      return s * Math.pow(2, -(bias - 1)) * (f / Math.pow(2, fbits));\n    } else {\n      return s * 0;\n    }\n  }\n\n  static generate16bit2sComplement(val: number): number {\n    throw new TypeError(\"not implemented yet\" + val);\n  }\n\n  static parse16bit2sComplement(byte1: number, byte2: number): number {\n    const unsigned = (byte1 << 8) | byte2;\n    if (unsigned & 0x8000) {\n      return unsigned | 0xffff0000;\n    } else {\n      return unsigned;\n    }\n  }\n\n  static parse32bit2sComplement(\n    byte1: number,\n    byte2: number,\n    byte3: number,\n    byte4: number\n  ): number {\n    const unsigned = (byte1 << 24) | (byte2 << 16) | (byte3 << 8) | byte4;\n    const s = (unsigned & 0x80000000) >> 31;\n    let res = unsigned & 0xffffffff;\n\n    if (s) {\n      res = (~unsigned & 0xffffffff) + 1;\n      return -1 * res;\n    }\n    return res;\n  }\n\n  /**\n   *\n   * @param {*} data string?\n   * @param {*} offset offset in the data\n   * @returns returns an integer between 0 and 65535 representing the UTF-16 code unit at the given index.\n   */\n  static getByteAt(data: string, offset: number): number {\n    const dataOffset = 0;\n    return data.charCodeAt(offset + dataOffset) & 0xff;\n  }\n\n  static extractPixelValue(\n    offset: number,\n    bytes: Uint8Array,\n    bitpix: number\n  ): number | undefined {\n    let px_val = undefined; // pixel value\n    // let px_val1, px_val2, px_val3, px_val4;\n\n    if (bitpix == 8){\n      px_val = bytes[0]\n    } else if (bitpix == 16) {\n      // 16-bit 2's complement binary integer\n      px_val = ParseUtils.parse16bit2sComplement(\n        bytes[offset],\n        bytes[offset + 1]\n      );\n    } else if (bitpix == 32) {\n      // IEEE 754 half precision (float16) ??\n      px_val = ParseUtils.parse32bit2sComplement(\n        bytes[offset],\n        bytes[offset + 1],\n        bytes[offset + 2],\n        bytes[offset + 3]\n      );\n    } else if (bitpix == -32) {\n      // 32-bit IEEE single-precision floating point\n      // px_val = ParseUtils.parse32bitSinglePrecisionFloatingPoint (this._u8data[offset], this._u8data[offset+1], this._u8data[offset+2], this._u8data[offset+3]);\n      px_val = ParseUtils.parseFloatingPointFormat(\n        bytes.slice(offset, offset + 8),\n        8,\n        23\n      );\n    } else if (bitpix == 64) {\n      // 64-bit 2's complement binary integer\n      throw new Error(\n        \"BITPIX=64 -> 64-bit 2's complement binary integer NOT supported yet.\"\n      );\n    } else if (bitpix == -64) {\n      // 64-bit IEEE double-precision floating point\n      //https://babbage.cs.qc.cuny.edu/ieee-754.old/Decimal.html\n      px_val = ParseUtils.parseFloatingPointFormat(\n        bytes.slice(offset, offset + 8),\n        11,\n        52\n      );\n    }\n\n    return px_val;\n  }\n\n}\n\n// export default ParseUtils;\n","/**\n * Summary. (bla bla bla)\n *\n * Description. (bla bla bla)\n *\n * @link   github https://github.com/fab77/fitsontheweb\n * @author Fabrizio Giordano <fabriziogiordano77@gmail.com>\n * import GnomonicProjection from './GnomonicProjection';\n * BITPIX definition from https://archive.stsci.edu/fits/fits_standard/node39.html\n * and \"Definition of the Flexible Image Transport System (FITS)\" standard document\n * defined by FITS Working Group from the International Astronomical Union\n * http://fits.gsfc.nasa.gov/iaufwg/\n * 8\t8-bit Character or unsigned binary integer\n * 16\t16-bit twos-complement binary integer\n * 32\t32-bit twos-complement binary integer\n * -32\t32-bit IEEE single precision floating point\n * -64\t64-bit IEEE double precision floating point\n *\n */\nimport { Blob } from 'blob-polyfill';\nimport { FITSHeaderItem } from \"./model/FITSHeaderItem.js\";\nimport { ParseUtils } from \"./ParseUtils.js\";\nimport { FITSHeader } from \"./model/FITSHeader.js\";\n// import fs from 'node:fs/promises';\n\nexport class FITSWriter {\n  _headerArray: Uint8Array;\n  _payloadArray: Uint8Array[];\n  _fitsData: Uint8Array;\n\n  constructor() {\n    this._headerArray = new Uint8Array();\n    this._payloadArray = new Array<Uint8Array>();\n    this._fitsData = new Uint8Array();\n  }\n\n  run(header: FITSHeader, rawdata: Uint8Array[]) {\n    this.prepareHeader(header);\n    this._payloadArray = rawdata;\n    this.prepareFITS();\n  }\n\n  prepareHeader(headerDetails: FITSHeader) {\n    const item = new FITSHeaderItem(\"END\");\n    headerDetails.addItem(item);\n\n    let str = \"\";\n    for (let i = 0; i < headerDetails.getItemList().length; i++) {\n      const item: FITSHeaderItem = headerDetails.getItemList()[i];\n      let s = this.formatHeaderLine(item);\n      if (s !== undefined) {\n        str += s;\n      }\n    }\n\n    const strBytelen = new TextEncoder().encode(str).length;\n\n    const nhdu = Math.ceil(strBytelen / 2880);\n    const offset = nhdu * 2880;\n\n    for (let j = 0; j < offset - strBytelen; j++) {\n      str += \" \";\n    }\n\n    const ab = new ArrayBuffer(str.length);\n    // Javascript character occupies 2 16-bit -> reducing it to 1 byte\n    this._headerArray = new Uint8Array(ab);\n    for (let i = 0; i < str.length; i++) {\n      this._headerArray[i] = ParseUtils.getByteAt(str, i);\n    }\n  }\n\n  // formatHeaderLine(item: string | undefined, value: string | number, comment: string) {\n  formatHeaderLine(item: FITSHeaderItem) {\n    let str;\n    let keyword = item.key;\n    let value = item.value;\n    let comment = item.comment;\n\n    if (keyword !== null && keyword !== undefined) {\n      str = keyword;\n\n      if (keyword == \"END\") {\n        for (let j = 80; j > keyword.length; j--) {\n          str += \" \";\n        }\n        return str;\n      }\n\n      if (keyword == \"COMMENT\" || keyword == \"HISTORY\") {\n        for (let i = 0; i < 10 - keyword.length; i++) {\n          str += \" \";\n        }\n        str += value;\n        const len = str.length;\n        for (let j = 80; j > len; j--) {\n          str += \" \";\n        }\n        return str;\n      }\n\n      for (let i = 0; i < 8 - keyword.length; i++) {\n        str += \" \";\n      }\n\n      str += \"= \";\n\n      if (value !== null && value !== undefined) {\n        // value\n        str += value;\n        if (comment !== null && comment !== undefined) {\n          str += comment;\n        }\n        const len = str.length;\n        for (let j = 80; j > len; j--) {\n          str += \" \";\n        }\n      } else {\n        if (comment !== null && comment !== undefined) {\n          str += comment;\n        }\n        const len = str.length;\n        for (let j = 80; j > len; j--) {\n          str += \" \";\n        }\n      }\n    } else {\n      // keyword null\n      str = \"\";\n      for (let j = 0; j < 18; j++) {\n        str += \" \";\n      }\n      if (comment !== null && comment !== undefined) {\n        str += comment;\n        const len = str.length;\n        for (let j = 80; j > len; j--) {\n          str += \" \";\n        }\n      } else {\n        str = \"\";\n        for (let j = 80; j > 0; j--) {\n          str += \" \";\n        }\n      }\n    }\n    return str;\n  }\n\n  prepareFITS() {\n    const bytes = new Uint8Array(\n      this._headerArray.length +\n      this._payloadArray[0].length * this._payloadArray.length\n    );\n\n    bytes.set(this._headerArray, 0);\n    for (let i = 0; i < this._payloadArray.length; i++) {\n      const uint8 = this._payloadArray[i];\n      bytes.set(uint8, this._headerArray.length + i * uint8.length);\n    }\n\n    this._fitsData = bytes;\n  }\n\n  // writeFITS(fileuri: string) {\n  //   // const dirname = path.dirname(fileuri);\n  //   // fs.mkdir(dirname, { recursive: true });\n  //   fs.writeFile(fileuri, this._fitsData);\n  //   // if (fs.existsSync(dirname)) {\n  //   //   fs.writeFileSync(fileuri, this._fitsData);\n  //   // } else {\n  //   //   console.error(dirname + \" doesn't exist\");\n  //   // }\n  // }\n\n  typedArrayToURL(): string {\n    const b = new Blob([this._fitsData], { type: \"application/fits\" });\n    // console.log(`<html><body><img src='${URL.createObjectURL(b)}'</body></html>`);\n    return URL.createObjectURL(b);\n  }\n}\n","// \"use strict\";\n\n/**\n * Summary. (bla bla bla)\n *\n * Description. (bla bla bla)\n *\n * @link   github https://github.com/fab77/FITSParser\n * @author Fabrizio Giordano <fabriziogiordano77@gmail.com>\n */\nimport { FITSHeader } from \"./model/FITSHeader.js\";\nimport { FITSHeaderItem } from \"./model/FITSHeaderItem.js\";\nimport { ParseUtils } from \"./ParseUtils.js\";\n\n// let colorsMap = new Map();\n// colorsMap.set(\"grayscale\",\"grayscale\");\n// colorsMap.set(\"planck\",\"planck\");\n// colorsMap.set(\"eosb\",\"eosb\");\n// colorsMap.set(\"rainbow\",\"rainbow\");\n// colorsMap.set(\"cmb\",\"cmb\");\n// colorsMap.set(\"cubehelix\",\"cubehelix\");\n\nexport class ParsePayload {\n  _u8data: Uint8Array;\n  _BZERO: number | undefined;\n  _BSCALE: number | undefined;\n  _BLANK: number | undefined;\n  _BITPIX: number | undefined;\n  _NAXIS1: number | undefined;\n  _NAXIS2: number | undefined;\n  _DATAMIN: number | undefined;\n  _DATAMAX: number | undefined;\n  _physicalblank: number | undefined;\n\n  constructor(fitsheader: FITSHeader, rawdata: Uint8Array) {\n\n    this._u8data = new Uint8Array();\n    this._BZERO = undefined;\n    this._BSCALE = undefined;\n    this._BLANK = undefined;\n    this._BITPIX = undefined;\n    this._NAXIS1 = undefined;\n    this._NAXIS2 = undefined;\n    this._DATAMIN = undefined;\n    this._DATAMAX = undefined;\n    this._physicalblank = undefined;\n\n    const buffer = rawdata.slice(fitsheader.offset);\n    this._u8data = new Uint8Array(buffer);\n    this.init(fitsheader);\n\n  }\n\n  init(fitsheader: FITSHeader) {\n    this._BZERO = fitsheader.get(\"BZERO\");\n    if (this._BZERO === undefined) {\n      this._BZERO = 0;\n    }\n    this._BSCALE = fitsheader.get(\"BSCALE\");\n    if (this._BSCALE === undefined) {\n      this._BSCALE = 1;\n    }\n    this._BLANK = fitsheader.get(\"BLANK\"); // undefined in case it's not present in the header\n    // this._BLANK_pv = this._BZERO + this._BSCALE * this._BLANK || undefined;\n    this._BITPIX = fitsheader.get(\"BITPIX\");\n    this._NAXIS1 = fitsheader.get(\"NAXIS1\");\n    this._NAXIS2 = fitsheader.get(\"NAXIS2\");\n    this._DATAMIN = fitsheader.get(\"DATAMIN\");\n    this._DATAMAX = fitsheader.get(\"DATAMAX\");\n\n    this._physicalblank = undefined;\n    if (this._DATAMAX === undefined || this._DATAMIN === undefined) {\n      const [min, max] = this.computePhysicalMinAndMax();\n      this._DATAMAX = max;\n      this._DATAMIN = min;\n      const maxitem = new FITSHeaderItem(\n        \"DATAMAX\",\n        max,\n        \" / computed with FITSParser\"\n      );\n      const minitem = new FITSHeaderItem(\n        \"DATAMIN\",\n        min,\n        \" / computed with FITSParser\"\n      );\n      fitsheader.addItem(maxitem);\n      fitsheader.addItem(minitem);\n      // fitsheader.set(\"DATAMAX\", max);\n      // fitsheader.set(\"DATAMIN\", min);\n    }\n    // let item = new FITSHeaderItem(\"END\", null, null);\n    // fitsheader.addItem(item);\n  }\n\n  computePhysicalMinAndMax(): [number | undefined, number | undefined] {\n    let i = 0;\n    if (this._BITPIX === undefined) {\n      throw new Error(\"BITPIX is not defined\");\n    }\n    const bytesXelem = Math.abs(this._BITPIX / 8);\n    const pxLength = this._u8data.byteLength / bytesXelem;\n    let px_val, ph_val;\n    let min = undefined;\n    let max = undefined;\n\n    if (this._BLANK !== undefined) {\n      this._physicalblank = this.pixel2physicalValue(this._BLANK);\n    }\n\n    while (i < pxLength) {\n      // px_val = this.extractPixelValue(bytesXelem*i);\n      px_val = this.extractPixelValue(bytesXelem * i);\n      if (px_val === undefined) {\n        i++;\n        continue;\n      }\n      ph_val = this.pixel2physicalValue(px_val);\n      if (min === undefined) {\n        min = ph_val;\n      }\n      if (max === undefined) {\n        max = ph_val;\n      }\n      //TODO check below if\n      if (this._physicalblank === undefined || this._physicalblank !== ph_val) {\n        if (ph_val !== undefined && (ph_val < min || min === undefined)) {\n          min = ph_val;\n        }\n\n        if (ph_val !== undefined && (ph_val > max || max === undefined)) {\n          max = ph_val;\n        }\n      }\n      i++;\n    }\n    return [min, max];\n  }\n\n  parse(): Array<Uint8Array> {\n    // let px_val; // pixel array value\n    // let ph_val = undefined; // pixel physical value\n    if (this._BITPIX === undefined) {\n      throw new Error(\"BITPIX is undefined\")\n    }\n    if (this._NAXIS1 === undefined) {\n      throw new Error(\"NAXIS1 is undefined\")\n    }\n    if (this._NAXIS2 === undefined) {\n      throw new Error(\"NAXIS2 is undefined\")\n    }\n    \n    const bytesXelem = Math.abs(this._BITPIX / 8);\n    let pxLength = this._u8data.byteLength / bytesXelem;\n    pxLength = this._NAXIS1 * this._NAXIS2;\n\n    let k = 0;\n    let c, r;\n    const pixelvalues = [];\n\n    //  let pixv, pv;\n    while (k < pxLength) {\n      r = Math.floor(k / this._NAXIS1); // row\n      c = (k - r * this._NAXIS1) * bytesXelem; // col\n      if (c === 0) {\n        pixelvalues[r] = new Uint8Array(this._NAXIS1 * bytesXelem);\n      }\n\n      // px_val = this.extractPixelValue(bytesXelem * k);\n      // ph_val = this.pixel2physicalValue(px_val);\n\n      // TODO check if ph_val == blank\n      // if not then use ph_val to compute datamin and datamax\n\n      for (let i = 0; i < bytesXelem; i++) {\n        pixelvalues[r][c + i] = this._u8data[k * bytesXelem + i];\n      }\n\n      // if (k == 232) {\n      // \tpixv = this.extractPixelValue(k * bytesXelem);\n      // \tpv = this._BZERO + this._BSCALE * pixv;\n      // }\n\n      k++;\n    }\n\n    return pixelvalues;\n  }\n\n  /** this can be deleted */\n  extractPixelValue(offset: number): number | undefined {\n    let px_val = undefined; // pixel value\n    if (this._BITPIX == 16) {\n      // 16-bit 2's complement binary integer\n      px_val = ParseUtils.parse16bit2sComplement(\n        this._u8data[offset],\n        this._u8data[offset + 1]\n      );\n    } else if (this._BITPIX == 32) {\n      // IEEE 754 half precision (float16) ??\n      px_val = ParseUtils.parse32bit2sComplement(\n        this._u8data[offset],\n        this._u8data[offset + 1],\n        this._u8data[offset + 2],\n        this._u8data[offset + 3]\n      );\n    } else if (this._BITPIX == -32) {\n      // 32-bit IEEE single-precision floating point\n      // px_val = ParseUtils.parse32bitSinglePrecisionFloatingPoint (this._u8data[offset], this._u8data[offset+1], this._u8data[offset+2], this._u8data[offset+3]);\n      px_val = ParseUtils.parseFloatingPointFormat(\n        this._u8data.slice(offset, offset + 4),\n        8,\n        23\n      );\n    } else if (this._BITPIX == 64) {\n      // 64-bit 2's complement binary integer\n      throw new Error(\n        \"BITPIX=64 -> 64-bit 2's complement binary integer NOT supported yet.\"\n      );\n    } else if (this._BITPIX == -64) {\n      // 64-bit IEEE double-precision floating point\n      //https://babbage.cs.qc.cuny.edu/ieee-754.old/Decimal.html\n      px_val = ParseUtils.parseFloatingPointFormat(\n        this._u8data.slice(offset, offset + 8),\n        11,\n        52\n      );\n    }\n\n    return px_val;\n  }\n\n  pixel2physicalValue(pxval: number): number{\n    if (this._BZERO === undefined || this._BSCALE === undefined) {\n      throw new Error(\"Either BZERO or BSCALE is undefined\");\n    }\n    return this._BZERO + this._BSCALE * pxval;\n    \n  }\n}\n","import { FITSHeader } from \"./model/FITSHeader.js\";\nimport { FITSHeaderItem } from \"./model/FITSHeaderItem.js\";\nimport { FITSHeaderLine } from \"./model/FITSHeaderLine.js\";\n/**\n * Summary. (bla bla bla)\n *\n * Description. (bla bla bla)\n *\n * @link   github https://github.com/fab77/FITSParser\n * @author Fabrizio Giordano <fabriziogiordano77@gmail.com>\n */\n\nexport class ParseHeader {\n  static parse(rawdata: Uint8Array): FITSHeader {\n    // only one header block (2880) allowed atm.\n    // TODO handle multiple header blocks\n    // let headerByteData = new Uint8Array(rawdata, 0, 2880);\n\n    const textDecoder = new TextDecoder(\"iso-8859-1\");\n\n    const header = new FITSHeader();\n\n    let nline = 0;\n    let key = \"\";\n    let val: string;\n\n    let u8line: Uint8Array;\n    let u8key: Uint8Array;\n    let u8val: Uint8Array;\n    let u8ind: Uint8Array;\n    // let ind: string;\n    let item: FITSHeaderItem | null;\n    let fitsLine: FITSHeaderLine;\n\n    item = null;\n\n    while (key !== \"END\" && rawdata.length > 0) {\n      // line 80 characters\n      u8line = new Uint8Array(rawdata.slice(nline * 80, nline * 80 + 80));\n      nline++;\n      // key\n      u8key = new Uint8Array(u8line.slice(0, 8));\n      key = textDecoder.decode(u8key).trim();\n      // value indicator\n      u8ind = new Uint8Array(u8line.slice(8, 10));\n      // ind = textDecoder.decode(u8ind);\n      // reading value\n      u8val = new Uint8Array(u8line.slice(10, 80));\n      val = textDecoder.decode(u8val).trim();\n      // ascii 61 -> =\n      // ascii 32 -> [space]\n      if (u8ind[0] == 61 && u8ind[1] == 32) {\n        let firstchar = 32;\n        for (let i = 0; i < u8val.length; i++) {\n          if (u8val[i] != 32) {\n            firstchar = u8val[i];\n            break;\n          }\n        }\n        // ascii 39 -> '\n        if (firstchar == 39 || !Number(val)) {\n          // [ival, icomment]\n          // fitsLine = ParseHeader.parseStringValue(u8val);\n          fitsLine = ParseHeader.parseLogicalValue(u8val);\n          \n        } else {\n          // ascii 84 -> T\n          // ascii 70 -> F\n          if (firstchar == 84 || firstchar == 70) {\n            // T or F\n            fitsLine = ParseHeader.parseLogicalValue(u8val);\n          } else {\n            val = textDecoder.decode(u8val).trim();\n            if (val.includes(\".\")) {\n              fitsLine = ParseHeader.parseFloatValue(u8val);\n            } else {\n              fitsLine = ParseHeader.parseIntValue(u8val);\n            }\n          }\n        }\n        item = new FITSHeaderItem(key, fitsLine.val, fitsLine.comment);\n      } else {\n        if (key == \"COMMENT\" || key == \"HISTORY\") {\n          item = new FITSHeaderItem(key, undefined, val);\n        } else {\n          let firstchar = 32;\n          for (let i = 0; i < u8val.length; i++) {\n            if (u8val[i] != 32) {\n              firstchar = u8val[i];\n              break;\n            }\n          }\n          if (firstchar == 47) {\n            // single / this is the case when no key nor value indicator is defined\n            item = new FITSHeaderItem(undefined, undefined, val);\n          } else if (firstchar == 32) {\n            // case when there's a line with only spaces\n            item = new FITSHeaderItem(undefined, undefined, undefined);\n          }\n        }\n      }\n      if (item != null) {\n        header.addItem(item);\n      }\n    }\n\n    item = new FITSHeaderItem(\n      \"COMMENT\",\n      \"FITS generated with FITSParser on \",\n      undefined\n    );\n    header.addItem(item);\n    const now = new Date();\n    item = new FITSHeaderItem(\"COMMENT\", now.toString());\n    header.addItem(item);\n\n    const nblock = Math.ceil(nline / 36);\n    const offset = nblock * 2880;\n\n    header.offset = offset;\n\n    return header;\n  }\n\n  static parseStringValue(u8buffer: Uint8Array): FITSHeaderLine {\n    const textDecoder = new TextDecoder(\"iso-8859-1\");\n    const decoded = textDecoder.decode(u8buffer).trim();\n    const idx = decoded.lastIndexOf(\"/\");\n    const val = decoded.substring(0, idx);\n    let comment = decoded.substring(idx);\n    // if (comment === undefined) {\n    //   comment = null;\n    // }\n    return {\n      val: val,\n      comment: comment,\n    };\n  }\n\n  static parseLogicalValue(u8buffer: Uint8Array): FITSHeaderLine {\n    const textDecoder = new TextDecoder(\"iso-8859-1\");\n    const val = textDecoder.decode(u8buffer).trim();\n    const tokens = val.split(\"/\");\n    if (tokens[1] === undefined) {\n      return {\n        val: tokens[0].trim(),\n        comment: undefined,\n      };\n    }\n    return {\n      val: tokens[0].trim(),\n      comment: \" /\" + tokens[1],\n    };\n  }\n\n  static parseIntValue(u8buffer: Uint8Array): FITSHeaderLine {\n    const textDecoder = new TextDecoder(\"iso-8859-1\");\n    const val = textDecoder.decode(u8buffer).trim();\n    const tokens = val.split(\"/\");\n    if (tokens[1] === undefined) {\n      return {\n        val: parseInt(tokens[0].trim()),\n        comment: undefined,\n      };\n    }\n    return {\n      val: parseInt(tokens[0].trim()),\n      comment: \" /\" + tokens[1],\n    };\n  }\n\n  static parseFloatValue(u8buffer: Uint8Array): FITSHeaderLine {\n    const textDecoder = new TextDecoder(\"iso-8859-1\");\n    const val = textDecoder.decode(u8buffer).trim();\n    const tokens = val.split(\"/\");\n    if (tokens[1] === undefined) {\n      return {\n        val: parseFloat(tokens[0].trim()),\n        comment: undefined,\n      };\n    }\n    return {\n      val: parseFloat(tokens[0].trim()),\n      comment: \" /\" + tokens[1],\n    };\n  }\n}\n","/**\n\n * @link   github https://github.com/fab77/FITSParser\n * @author Fabrizio Giordano <fabriziogiordano77@gmail.com>\n */\n\nimport { FITSWriter } from \"./FITSWriter.js\";\nimport { ParsePayload } from \"./ParsePayload.js\";\nimport { ParseHeader } from \"./ParseHeader.js\";\nimport { FITSHeader } from \"./model/FITSHeader.js\";\nimport { FITSParsed } from \"./model/FITSParsed.js\";\n// import fetch from 'cross-fetch';\n// import { readFile } from \"node:fs/promises\";\n\nexport class FITSParser {\n  _url: string;\n\n  constructor(url: string) {\n    this._url = url;\n  }\n\n  async loadFITS(): Promise<FITSParsed | null> {\n    return this.getFile(this._url)\n      .then((rawdata) => {\n        if (rawdata !== null && rawdata.byteLength > 0) {\n          const uint8 = new Uint8Array(rawdata);\n          const fits = this.processFits(uint8);\n          return fits;\n        }\n        return null;\n      })\n      .catch((error) => {\n        if (error?.response?.data?.message) {\n          throw new Error(\n            \"[FITSParser->loadFITS] \" + error.response.data.message\n          );\n        }\n        throw error;\n      });\n  }\n\n  processFits(rawdata: Uint8Array): FITSParsed {\n    const header: FITSHeader = ParseHeader.parse(rawdata);\n\n    const payloadParser = new ParsePayload(header, rawdata);\n    const pixelvalues = payloadParser.parse();\n    // if (rawdata.length > (header.getNumRows() + (pixelvalues.length * pixelvalues[0].length))) {\n    // let leftover = rawdata.length - (header.getNumRows() + (pixelvalues.length * pixelvalues[0].length));\n    // \tthrow new Error(\"[FITSParser->processFits] It seems that there's at least one more HDU since there are \" + leftover + \" bytes not processed.\");\n    // \tconsole.warn(\"It seems that there's at least one more HDU since there are \" + leftover + \" bytes not processed.\")\n    // }\n    return {\n      header: header,\n      data: pixelvalues,\n    };\n  }\n\n  static generateFITS(header: FITSHeader, rawdata: Uint8Array[]) {\n    const writer = new FITSWriter();\n    writer.run(header, rawdata);\n    return writer.typedArrayToURL();\n  }\n\n  async getFile(uri: string): Promise<Buffer | ArrayBuffer> {\n\n    let data;\n    if (!uri.substring(0, 5).toLowerCase().includes(\"http\")) {\n\n      let p = await import('./getLocalFile.js')\n      // data = await p.getLocalFile(uri);\n      return await p.getLocalFile(uri);\n\n    } else {\n\n      let p = await import('./getFile.js')\n\n      return p.getFile(uri).then((data) => {\n        return data;\n      }).catch((err) => {\n        // console.error(\"Error in FITSParser getFile \", uri, err);\n        return null;\n      });\n      // data = await p.getFile(uri);\n      // return await p.getFile(uri).catch((err) => {\n      //   console.error(err);\n      // });\n\n    }\n    // return data;\n\n  }\n\n\n}\n"],"names":["root","factory","exports","module","define","amd","self","inProgress","dataWebpackPrefix","global","window","g","this","BlobBuilder","WebKitBlobBuilder","MSBlobBuilder","MozBlobBuilder","URL","webkitURL","href","a","document","createElement","origBlob","Blob","createObjectURL","revokeObjectURL","strTag","Symbol","toStringTag","blobSupported","blobSupportsArrayBufferView","blobBuilderSupported","prototype","append","getBlob","size","Uint8Array","e","mapArrayBufferViews","ary","map","chunk","buffer","ArrayBuffer","buf","byteLength","copy","set","byteOffset","BlobBuilderConstructor","options","bb","forEach","part","type","BlobConstructor","textEncode","TextEncoder","encode","bind","string","pos","len","length","Arr","Array","at","tlen","Math","max","target","value","charCodeAt","extra","update","slice","textDecode","TextDecoder","decode","end","res","i","secondByte","thirdByte","fourthByte","tempCodePoint","firstByte","codePoint","bytesPerSequence","push","str","j","String","fromCharCode","apply","fixFileAndXHR","isIE","ActiveXObject","documentElement","style","_send","XMLHttpRequest","send","data","setRequestHeader","call","File","FileReader","Function","b","d","c","blob","t","lastModified","Date","name","replace","lastModifiedDate","toString","bufferClone","view","array","array2base64","input","byteToCharMap","output","byte1","haveByte2","byte2","haveByte3","byte3","outByte1","outByte2","outByte3","outByte4","join","create","Object","getObjectTypeName","o","isPrototypeOf","arrayBufferClassNames","isArrayBuffer","v","indexOf","chunks","opts","_buffer","DataView","offset","concatTypedarrays","concat","test","toLowerCase","arrayBuffer","Promise","resolve","text","start","constructor","setPrototypeOf","__proto__","TypeError","delegate","createDocumentFragment","addEventListener","dispatchEvent","evt","local","removeEventListener","_read","fr","kind","result","setTimeout","readyState","LOADING","Event","EMPTY","DONE","error","onabort","onerror","onload","onloadend","onloadstart","onprogress","readAsDataURL","readAsText","readAsArrayBuffer","abort","url","FakeBlobBuilder","stream","ReadableStream","position","autoAllocateChunkSize","pull","controller","byobRequest","then","uint8array","bytesRead","respond","close","enqueue","Response","body","getReader","read","Error","promisify","obj","reject","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","m","n","getter","__esModule","definition","key","defineProperty","enumerable","get","f","chunkId","all","keys","reduce","promises","u","globalThis","prop","hasOwnProperty","l","done","script","needAttach","scripts","getElementsByTagName","s","getAttribute","charset","timeout","nc","setAttribute","src","onScriptComplete","prev","event","clearTimeout","doneFns","parentNode","removeChild","fn","head","appendChild","r","scriptUrl","importScripts","location","currentScript","p","installedChunks","installedChunkData","promise","errorType","realSrc","message","request","webpackJsonpCallback","parentChunkLoadingFunction","chunkIds","moreModules","runtime","some","id","chunkLoadingGlobal","FITSHeaderItem","comment","_key","_value","_comment","FITSHeader","Map","super","_offset","_items","getItemList","getItemListOf","item","addItemAtTheBeginning","includes","newitemlist","addItem","getNumRows","ParseUtils","static","chars","substr","byte4","long","pow","blank","nbytes","abs","uint8","parseInt","bytes","ebits","fbits","bits","byte","reverse","bias","substring","Infinity","val","unsigned","bitpix","px_val","parse16bit2sComplement","parse32bit2sComplement","parseFloatingPointFormat","FITSWriter","_headerArray","_payloadArray","_fitsData","run","header","rawdata","prepareHeader","prepareFITS","headerDetails","formatHeaderLine","strBytelen","ceil","ab","getByteAt","keyword","typedArrayToURL","ParsePayload","fitsheader","_u8data","_BZERO","_BSCALE","_BLANK","_BITPIX","_NAXIS1","_NAXIS2","_DATAMIN","_DATAMAX","_physicalblank","init","min","computePhysicalMinAndMax","maxitem","minitem","bytesXelem","pxLength","ph_val","pixel2physicalValue","extractPixelValue","parse","k","pixelvalues","floor","pxval","ParseHeader","textDecoder","u8line","u8key","u8val","u8ind","fitsLine","nline","trim","firstchar","Number","parseLogicalValue","parseFloatValue","parseIntValue","now","u8buffer","decoded","idx","lastIndexOf","tokens","split","parseFloat","FITSParser","_url","loadFITS","getFile","processFits","catch","response","writer","uri","err","getLocalFile"],"sourceRoot":""}